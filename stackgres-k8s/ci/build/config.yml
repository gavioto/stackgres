maven_opts: |
  -Dhttps.protocols=TLSv1.2
  -Dorg.slf4j.simpleLogger.showDateTime=true
  -Djava.awt.headless=true
  -XX:+UseParallelGC
maven_cli_opts: |
  -f stackgres-k8s/src/pom.xml
  --batch-mode
  --errors
  --fail-at-end
  --show-version
  -Dmaven.repo.local=stackgres-k8s/src/.m2/repository
  -DinstallAtEnd=true
  -DdeployAtEnd=true
  -Dsurefire.useFile=false
  -Dsurefire.useFile=false
  -DtrimStackTrace=false
base_jvm_image: registry.access.redhat.com/ubi8/openjdk-11:1.3-10
base_native_image: registry.access.redhat.com/ubi8-minimal:8.3-298.1618432845
modules:
  stackgres-parent:
    type: java
    path: .
  operator-framework:
    type: java
  test-util:
    type: java
  common:
    type: java
  operator:
    type: java
  restapi:
    type: java
    path: api-web
    post_build_commands:
      - 'microdnf install python3-pip jq'
      - 'pip3 install yamllint yq'
      - 'sh stackgres-k8s/src/api-web/src/main/swagger/build.sh'
  jobs:
    type: java
  cluster-controller:
    type: java
  distributedlogs-controller:
    type: java
  admin-ui:
    type: web
  operator-jvm-image:
    type: jvm-image
    name: operator
  restapi-jvm-image:
    type: jvm-image
    name: restapi
    path: api-web
  jobs-jvm-image:
    type: jvm-image
    name: jobs
  cluster-controller-jvm-image:
    type: jvm-image
    name: cluster-controller
  distributedlogs-controller-jvm-image:
    type: jvm-image
    name: distributedlogs-controller
  admin-ui-image:
    type: image
    path: admin-ui
    base_image: registry.access.redhat.com/ubi8/nginx-118:1-18.1614609200
  operator-native:
    type: native
    name: operator
  restapi-native:
    type: native
    name: restapi
    path: api-web
  jobs-native:
    type: native
    name: jobs
  cluster-controller-native:
    type: native
    name: cluster-controller
  distributedlogs-controller-native:
    type: native
    name: distributedlogs-controller
  operator-native-image:
    type: native-image
    name: operator
  restapi-native-image:
    type: native-image
    name: restapi
    path: api-web
  jobs-native-image:
    type: native-image
    name: jobs
  cluster-controller-native-image:
    type: native-image
    name: cluster-controller
  distributedlogs-controller-native-image:
    type: native-image
    name: distributedlogs-controller
stages:
  - stackgres-parent: null
  - operator-framework: stackgres-parent
  - test-util: operator-framework
  - common: test-util
  - operator: common
  - restapi: common
  - jobs: common
  - cluster-controller: common
  - distributedlogs-controller: common
  - admin-ui: restapi
  - operator-jvm-image: operator
  - restapi-jvm-image: restapi
  - jobs-jvm-image: jobs
  - cluster-controller-jvm-image: cluster-controller
  - distributedlogs-controller-jvm-image: distributedlogs-controller
  - admin-ui-image: admin-ui
  - operator-native: operator
  - restapi-native: restapi
  - jobs-native: jobs
  - cluster-controller-native: cluster-controller
  - distributedlogs-controller-native: distributedlogs-controller
  - operator-native-image: operator-native
  - restapi-native-image: restapi-native
  - jobs-native-image: jobs-native
  - cluster-controller-native-image: cluster-controller-native
  - distributedlogs-controller-native-image: distributedlogs-controller-native
